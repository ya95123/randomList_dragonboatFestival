<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é€é¤åˆ°ä½ å®¶ï¼</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      list-style: none;
      box-sizing: border-box;
      font-family: é»‘é«”-ç¹, Apple LiGothic Medium, PingFang, å¾®è»Ÿæ­£é»‘é«”, Microsoft JhengHei, WenQuanYi Zen Hei, helvetica, Arial, sans-serif;
    }

    html,
    body {
      height: 100%;
      font-weight: bold;
      text-align: center;
      letter-spacing: 1px;
      background: #8CA653;
      color: #CFE4DB;
    }

    body {
      padding: 0 8px;
    }

    ::selection {
      color: rgb(255, 232, 25);
    }

    h1 {
      padding: 1.5rem 0;
    }

    input {
      height: 1.5rem;
      margin: 8px 0;
      padding: 0 4px;
      border-radius: 4px;
      background: #fff;
      border: none;
    }

    button {
      display: block;
      padding: 0.5rem 1rem;
      margin: 1.5rem auto;
      border: none;
      border-radius: 13px;
      cursor: pointer;
      opacity: 0.9;
      transition: 0.25s;
    }

    button:hover {
      opacity: 1;
    }

    p {
      margin: 0.65rem 0;
    }

    #submit {
      transition: 0.25s;
    }

    #submit:hover {
      cursor: pointer;
      color: rgb(255, 232, 25);
    }

    #result {
      color: #fff;
      font-size: 2rem;
      transition: 0.3s;
    }

    .three {
      width: 300px;
      height: 150px;
      margin: auto;
      display: flex;
      justify-content: center;
      align-items: flex-end;
    }

    .three-left,
    .three-mid,
    .three-right {
      position: relative;
    }

    .three-mid {
      align-self: flex-start;
    }

    .three-left::before {
      content: 'âš';
      position: absolute;
      left: 40%;
      top: -100%;
    }

    .three-mid::before {
      content: 'â˜';
      position: absolute;
      right: -50%;
      top: 100%;
    }

    .three-right::before {
      content: 'â™';
      position: absolute;
      left: -75%;
      top: 7%;
      transform: rotate(180deg);
    }
  </style>
</head>

<body>
  <h1>ğŸ²é€é¤åˆ°ä½ å®¶ï¼</h1>
  <h4>è¼¸å…¥åå–®
    <input id="inputList" type="text" size="35" placeholder="è«‹ç”¨å°å¯«é€—è™Ÿ , åˆ†éš”åå­—ï¼">
    <span id="submit">é€å‡º</span>
  </h4>

  <h4>åƒèˆ‡å®¶äººï¼š<span id="people">å¤šå¤š,å°èŠ±,è²æ¯”(ç¯„ä¾‹)</span></h4>

  <button id="start" style="cursor: pointer;">é–‹å§‹åˆ†é…</button>

  <div id="result" style="opacity: 0;"></div>

  <script>
    const inputList = document.getElementById("inputList")
    const submit = document.getElementById("submit")
    const people = document.getElementById("people")
    const start = document.getElementById("start")
    const result = document.getElementById("result")

    let team = []
    let timeCount = 0
    let teamLen, teamDiv, teamCount

    // éš¨æ©Ÿ
    const rand = (min, max) => {
      return Math.floor(Math.random() * (max - min + 1) + min)
    }

    // å¤§å¯«é€—è™Ÿè½‰å°å¯«
    const transDot = (str) => {
      return str.replace(/ï¼Œ/g, ',')
    }

    // é€å‡ºåå–®
    const submitList = () => {
      let input = transDot(inputList.value)

      // æ–‡å­—è½‰é™£åˆ—
      team = input.split(",")

      // é™£åˆ—è³‡è¨Š
      teamLen = team.length
      teamDiv = teamLen / 2
      teamCount = Math.round(teamDiv)

      // é¡¯ç¤ºåƒèˆ‡è€…
      people.innerText = team
    }

    // æ•´é™¤åˆ†é…
    const intTeam = () => {
      for (let i = 0; i < teamCount; i++) {
        result.insertAdjacentHTML("beforeend", `
        <p><span class="name"></span> â†” <span class="name"></span></p>
        `)
      }
    }

    // éæ•´é™¤åˆ†é…
    const floatTeam = () => {
      let len = teamCount - 2
      // é›™
      for (let i = 0; i < len; i++) {
        result.insertAdjacentHTML("beforeend", `
        <p><span class="name"></span> â†” <span class="name"></span></p>
        `)
      }
      // ä¸‰
      result.insertAdjacentHTML("beforeend", `
      <div class="three">
        <p class="three-left"><span class="name"></span></p>
        <p class="three-mid"><span class="name"></span></p>
        <p class="three-right"><span class="name"></span></p>
      </div>
        `)
    }

    // åˆ†é…åå–®
    const nameList = () => {
      const names = document.querySelectorAll(".name")
      const list = []

      for (let i = 0; i < teamLen; i++) {
        // éš¨æ©Ÿåå­—
        let name = team[rand(0, teamLen - 1)]
        // é¿å…é‡è¤‡
        while (list.includes(name)) {
          name = team[rand(0, teamLen - 1)]
        }
        // æ¨å…¥é™£åˆ—ã€ä¸¦é¡¯ç¤ºæ–‡å­—
        list.push(name)
        names[i].innerText = list[i]
      }
    }

    // input submit
    submit.addEventListener("click", submitList, false)
    document.addEventListener("keydown", (val) => {
      if (val.keyCode === 13) submitList()
    }, false)

    // Start
    start.addEventListener("click", () => {
      if (team.length === 0) {
        alert("æœªè¼¸å…¥åå–®")
        return
      }
      if (team.length < 3) {
        alert("åå–®è‡³å°‘éœ€è¦è¼¸å…¥ 3 äºº")
        return
      }

      // åˆå§‹ resultã€è¨ˆæ™‚å™¨ã€æŒ‰éˆ•ç¦æ­¢
      result.innerHTML = ""
      timeCount = 0
      start.disabled = true
      start.style.cursor = "not-allowed"
      result.style.opacity = "0"

      // å‡ºç¾ result
      result.style.opacity = "1"

      // æ’å…¥ html
      // å››æ¨äº”å…¥å¯åˆ¤åˆ¥æ˜¯å¥‡æ•¸(ä¸æ•´é™¤ï¼Œæœƒå¤š0.5)æˆ–å¶æ•¸(æ•´é™¤)
      Math.round(teamDiv) === teamDiv ? intTeam() : floatTeam()

      // éš¨æ©Ÿé¡¯ç¤º
      let timer = setInterval(() => {
        nameList()
        timeCount += 100
        // æš«åœ
        if (timeCount === 3000) {
          clearInterval(timer)
          start.disabled = false
          start.style.cursor = "pointer"
        }
      }, 100)

    }, false)

  </script>
</body>

</html>